<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Election Prediction Quiz</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<style>
  body{
    font-family:Arial,Helvetica,sans-serif;margin:0;background:#fafafa;
    display:flex;flex-direction:column;align-items:center;padding:20px;
  }
  .container{display:flex;gap:16px;flex-wrap:wrap;justify-content:center}
  .panel{
    background:#fff;border:1px solid #ccc;border-radius:8px;
    box-shadow:0 2px 6px rgba(0,0,0,.05);padding:16px;display:flex;flex-direction:column
  }
  .slots.panel{width:260px;max-height:560px;overflow:auto}
  .bank.panel{width:300px;max-height:560px;overflow:auto}
  h2{margin:0 0 10px;font-size:18px;text-align:center}
  ul{list-style:none;margin:0;padding:0}

  /* Ranks list (26 rows) */
  .ranks li{
    border:1px dashed #ccc;border-radius:6px;background:#fdfdfd;
    display:flex;align-items:center;justify-content:space-between;
    padding:6px 8px;margin:6px 0;min-height:36px;gap:8px
  }
  .ranks li.locked{background:linear-gradient(#fff7c2,#ffef8a);border:1px solid #e0b000;font-weight:700}
  .rank-num{color:#555;min-width:22px;text-align:right;margin-right:6px}
  .slot-body{flex:1;display:flex;align-items:center;gap:6px;min-height:24px}

  /* Candidate pills */
  .candidate{
    border:1px solid #ccc;border-radius:14px;background:#f5f5f5;
    padding:4px 10px;white-space:nowrap;cursor:grab;touch-action:none;display:inline-block;
  }

  /* Bank list holds candidates directly as children */
  .bank-list{display:flex;flex-direction:column}
  .bank-list .candidate{margin:6px 0}

  .btn{margin-top:8px;width:100%;padding:8px;border:1px solid #ccc;background:#eee;border-radius:6px;cursor:pointer}

  #messageBox{position:fixed;top:16px;left:50%;transform:translateX(-50%);
    font-size:22px;font-weight:700;opacity:0;transition:opacity .4s;pointer-events:none}
  #messageBox.show{opacity:1}

  .footer-note{margin-top:14px;font-size:14px;color:#555;text-align:center}

  @media (max-width:600px){
    .slots.panel,.bank.panel{width:100%;max-height:60vh}
  }
</style>
</head>
<body>
<div id="messageBox"></div>

<div class="container">
  <!-- Left: Ranks -->
  <div class="panel slots">
    <h2>Your Prediction (1–26)</h2>
    <ul id="ranks" class="ranks"></ul>
    <button id="reset" class="btn">Reset</button>
    <button id="submit" class="btn">Submit My Picks</button>
  </div>

  <!-- Right: Bank -->
  <div class="panel bank">
    <h2>Candidate List</h2>
    <ul id="bank" class="bank-list"></ul>
  </div>
</div>

<p class="footer-note">Press “Submit My Picks” to upload your list via Google Forms.</p>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
<script>
const candidates = [
  "Anna Albi","Jeff Cramerding","Mark Jeffreys","Scotty Johnson",
  "Jan-Michele Lemon Kearney","Evan Nolan","Meeka Owens","Seth Walsh",
  "Audricia Brooks","Laketa Cole","Jerry Corbett","Don Driehaus",
  "Kevin Farmer","Gary Favors","Steve Goodin","Ryan James",
  "Dawn Johnson","Liz Keating","Dale Mallory","Linda Matthews",
  "Brandon Nixon","Raffel Prophett","Stephan Pryor",
  "Christopher Smitherman","Donald Washington","Aaron Weiner"
];

const ranksUl = document.getElementById('ranks');
const bankUl  = document.getElementById('bank');
const msgBox  = document.getElementById('messageBox');
const GROUP   = { name: 'preds', pull: true, put: true }; // real moves, no clones

// Build 26 rank rows with slot-body
for (let i = 1; i <= 26; i++) {
  const row = document.createElement('li');
  if (i <= 9) row.classList.add('locked');
  row.dataset.rank = i;

  const num = document.createElement('span');
  num.className = 'rank-num';
  num.textContent = i + '.';

  const slotBody = document.createElement('div');
  slotBody.className = 'slot-body';

  row.appendChild(num);
  row.appendChild(slotBody);
  ranksUl.appendChild(row);

  // Make each slot-body a Sortable container
  new Sortable(slotBody, {
    group: GROUP,
    draggable: '.candidate',
    sort: false,
    animation: 150,
    onAdd: (evt) => {
      enforceSingle(slotBody, evt.item);
      signal(row);
    }
  });
}

// Populate bank with real, movable candidates (no li wrappers)
for (const name of candidates) {
  const pill = document.createElement('span');
  pill.className = 'candidate';
  pill.textContent = name;
  bankUl.appendChild(pill);
}

// Sortable for bank — same group, real moves
new Sortable(bankUl, {
  group: GROUP,
  draggable: '.candidate',
  sort: false,
  animation: 150
});

// Ensure one candidate per slot; send any existing back to bank
function enforceSingle(slotBody, incomingPill) {
  const existing = slotBody.querySelector('.candidate');
  if (existing && existing !== incomingPill) {
    bankUl.appendChild(existing);
  }
  slotBody.appendChild(incomingPill);
}

// Show “I win” / “Oh no I lost!”
function signal(row) {
  const rank = parseInt(row.dataset.rank, 10);
  if (rank <= 9) showMessage("I win!", "#28a745");
  else showMessage("Oh no I lost!", "#d9534f");
}

function showMessage(text, color) {
  msgBox.textContent = text;
  msgBox.style.color = color;
  msgBox.classList.add('show');
  setTimeout(() => msgBox.classList.remove('show'), 900);
}

// Click-to-remove: move back to bank
document.addEventListener('click', (e) => {
  const pill = e.target.closest('.candidate');
  if (!pill) return;
  const slotBody = pill.parentElement;
  if (slotBody && slotBody.classList.contains('slot-body')) {
    bankUl.appendChild(pill);
  }
});

// Reset
document.getElementById('reset').onclick = () => {
  document.querySelectorAll('.slot-body .candidate').forEach(p => bankUl.appendChild(p));
};

// Submit to Google Form (one candidate per line)
const formURL = "https://docs.google.com/forms/d/e/1FAIpQLSdNiSyMjsEWg62XTa3hXsJrYzHLe9mAsF2AUZWP-LAqEv9atg/viewform?usp=pp_url&entry.366340186=";
document.getElementById('submit').onclick = () => {
  const lines = [];
  document.querySelectorAll('#ranks > li').forEach((row, idx) => {
    const pill = row.querySelector('.slot-body .candidate');
    lines.push(`${idx+1}. ${pill ? pill.textContent : ""}`);
  });
  const payload = lines.join("\n");
  window.open(formURL + encodeURIComponent(payload), "_blank");
};
</script>
</body>
</html>
